<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-content/interacting/search-with-permissions">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.21">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@500;600&display=swap">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"><title data-rh="true">Search With Permissions | OpenFGA</title><meta data-rh="true" http-equiv="Content-Security-Policy" content="default-src &#x27;none&#x27;; base-uri &#x27;self&#x27;; block-all-mixed-content; child-src www.youtube-nocookie.com; prefetch-src &#x27;self&#x27;; connect-src &#x27;self&#x27; https://raw.githubusercontent.com https://s3.amazonaws.com https://cdn.cookielaw.org https://privacyportal.onetrust.com https://heapanalytics.com; font-src &#x27;self&#x27; https://fonts.googleapis.com https://fonts.gstatic.com; form-action &#x27;none&#x27;; frame-src www.youtube-nocookie.com; img-src &#x27;self&#x27; data: https://pbs.twimg.com https://docs.github.com https://heapanalytics.com; media-src &#x27;none&#x27;; object-src &#x27;none&#x27;; script-src &#x27;self&#x27; &#x27;unsafe-inline&#x27; https://cdn.cookielaw.org https://geolocation.onetrust.com https://cdn.heapanalytics.com; style-src &#x27;unsafe-inline&#x27; &#x27;self&#x27; https://fonts.googleapis.com;"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://openfga.dev/docs/interacting/search-with-permissions"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="keywords" content="OpenFGA, open source, fine-grained-authorization, fine grained authorization, Zanzibar"><meta data-rh="true" property="og:image" content="https://openfga.dev/img/og-rich-embed.png"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Search With Permissions | OpenFGA"><meta data-rh="true" name="description" content="The recommended ways to integrate FGA into your search"><meta data-rh="true" property="og:description" content="The recommended ways to integrate FGA into your search"><link data-rh="true" rel="icon" href="/img/openfga-icon.svg"><link data-rh="true" rel="canonical" href="https://openfga.dev/docs/interacting/search-with-permissions"><link data-rh="true" rel="alternate" href="https://openfga.dev/docs/interacting/search-with-permissions" hreflang="en"><link data-rh="true" rel="alternate" href="https://openfga.dev/docs/interacting/search-with-permissions" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.40fd94cd.css">
<link rel="preload" href="/assets/js/runtime~main.d5edf52b.js" as="script">
<link rel="preload" href="/assets/js/main.bc493a09.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div class="CustomizedRoot"><div role="region"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><div class="announcementBar_mb4j" role="banner"><div class="announcementBarPlaceholder_vyr4"></div><div class="announcementBarContent_xLdY">OpenFGA is an open source Fine-Grained Authorization solution based on Google's Zanzibar. We welcome community contribution to this project.</div><button type="button" class="clean-btn close announcementBarClose_gvF7" aria-label="Close"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" target="_self" href="/"><div class="navbar__logo"><img src="/img/openfga_logo.svg" alt="OpenFGA" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/openfga_logo.svg" alt="OpenFGA" class="themedImage_ToTc themedImage--dark_i4oU"></div></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/">Home</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/authorization-and-openfga">Docs</a><a class="navbar__item navbar__link" href="/api/service">API</a></div><div class="navbar__items navbar__items--right"><a href="https://twitter.com/OpenFGA" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-social header-twitter-link" aria-label="OpenFGA on Twitter">Twitter</a><a href="https://discord.gg/8naAwJfWN6" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-social header-discord-link" aria-label="OpenFGA on Discord">Discord</a><a href="https://github.com/openfga" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-social header-github-link" aria-label="OpenFGA on GitHub">Github</a><div class="searchBox_ZlJk"><div class="navbar__search searchBarContainer_NW3z"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div><div class="searchHintContainer_Pkmr"><kbd class="searchHint_iIMx">ctrl</kbd><kbd class="searchHint_iIMx">K</kbd></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/authorization-and-openfga">What is OpenFGA</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/concepts">Concepts</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/configuration-language">Configuration Language</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="/docs/getting-started">Getting Started</a><button aria-label="Toggle the collapsible sidebar category &#x27;Getting Started&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/getting-started/setup-openfga">Setup OpenFGA Server</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/getting-started/install-sdk">Install SDK Client</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/getting-started/create-store">Create a Store</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/getting-started/setup-sdk-client">Setup SDK Client for Store</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/getting-started/configure-model">Configure Authorization Model</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/getting-started/update-tuples">Update Relationship Tuples</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/getting-started/perform-check">Perform a Check</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/getting-started/framework">Integrate Within a Framework</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/modeling">Modeling Guides</a><button aria-label="Toggle the collapsible sidebar category &#x27;Modeling Guides&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/interacting">Interacting with the API</a><button aria-label="Toggle the collapsible sidebar category &#x27;Interacting with the API&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/interacting/managing-user-access">Manage User Access</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/interacting/managing-group-access">Manage Group Access</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/interacting/managing-group-membership">Manage Group Membership</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/interacting/managing-relationships-between-objects">Manage Relationships Between Objects</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/interacting/transactional-writes">Transactional Writes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/interacting/check-read-expand">Check, Read and Expand</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/interacting/read-tuple-changes">Get Tuple Changes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/interacting/search-with-permissions">Search with Permissions</a></li></ul></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_GujU"><div class="docItemContainer_Adtb"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/interacting"><span itemprop="name">Interacting with the API</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Search with Permissions</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_aoJ5"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Search With Permissions</h1><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><div>OpenFGA is an open source Fine-Grained Authorization solution based on Google's Zanzibar. We welcome community contribution to this project.</div></div></div><p>Once you implement fine-grained authorization to protect your resources, search becomes a more complex problem, because the user&#x27;s access to each resource now has to be validated before the resource can be shown.</p><p>The search problem can then be summarized as:</p><blockquote><p>&quot;Given a particular search filter and a sort order, what objects can the user access&quot;?</p></blockquote><p>The <!-- -->OpenFGA<!-- --> service does not store object metadata (names of files, creation dates, time of last update, etc), which means completing any search request by filtering and sorting according to certain criteria will require data from your database.</p><p>The services responsible for performing these actions are:</p><ul><li>Filter: Your database</li><li>Sort: Your database</li><li>Authorize: <!-- -->OpenFGA</li></ul><p>To return the set of results that match the user&#x27;s search query, you will need to get the intersection of the results from the services above.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="possible-options">Possible Options<a class="hash-link" href="#possible-options" title="Direct link to heading">​</a></h2><p>There are three possible ways to do this:</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="option-1-search-then-check">Option 1: Search, Then Check<a class="hash-link" href="#option-1-search-then-check" title="Direct link to heading">​</a></h3><p>Pre-filter, then call <!-- -->OpenFGA<!-- --> Check endpoint.</p><ol><li>Filter and sort on your database.</li><li>Call <a href="/docs/interacting/check-read-expand#check"><code>/check</code></a> in parallel on each object returned from your database.</li><li>Filter out objects the user does not have access to.</li><li>Return the filtered result to the user.</li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="option-2-build-a-local-index-from-changes-endpoint-search-then-check">Option 2: Build A Local Index From Changes Endpoint, Search, Then Check<a class="hash-link" href="#option-2-build-a-local-index-from-changes-endpoint-search-then-check" title="Direct link to heading">​</a></h3><p>Consume the <code>GET /changes</code> endpoint to create a local index you can use to do an intersection on the two sets of results.</p><ol><li>Call the <a href="/api/service#Relationship%20Tuples/ReadChanges">OpenFGA changes API</a>.</li><li>For the particular authorization model version(s) you are using in production, flatten/expand the changes (e.g. <code>user:anne, writer, doc:planning</code> becomes two tuples: <code>user:anne, writer, doc:planning</code> and <code>user:anne, reader, doc:planning</code>).</li><li>Build the intersection between the objects in your database and the flattened/expanded state you created.</li><li>You can then call <code>/check</code> on each resource in the resulting set before returning the response to filter out any resource with permissions revoked but whose authorization data has not made it into your index yet.</li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="option-3-build-a-list-of-ids-then-search">Option 3: Build A List Of IDs, Then Search<a class="hash-link" href="#option-3-build-a-list-of-ids-then-search" title="Direct link to heading">​</a></h3><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>Support for this option has not been added to <!-- -->OpenFGA<!-- --> yet, but we will keep it here for the sake of completion.</p></div></div><p>Call the <!-- -->OpenFGA<!-- --> API to get a list of object IDs the user has access to, then run the filter restricting by the object IDs returned.</p><ol><li>Call <!-- -->OpenFGA<!-- -->&#x27;s API to get the list of all resources a user can access.</li><li>Pass in the set of object IDs to the database query to limit the search.</li><li>Return the filtered result to the user.</li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="choosing-the-best-option">Choosing The Best Option<a class="hash-link" href="#choosing-the-best-option" title="Direct link to heading">​</a></h2><p>Which option to choose among the three listed above depends on the following criteria:</p><ol><li>Number of objects that your database can return from a search query</li><li>Number of objects of a certain type the user could have access to</li><li>Percentage of objects in a type the user could have access to</li></ol><p>Consider the following scenarios:</p><p><strong>A.</strong> The <em>number of objects a search query could return from the database</em> is <em>low</em>.</p><p><strong><a href="#option-1-search-then-check">Search then Check</a></strong> is the recommended solution.</p><p>Use-case: Situations where the search query can be optimized to return a small number of results.</p><p><strong>B.</strong> The <em>number of objects of a certain type the user could have access to</em> is <em>low</em>, and the <em>percentage of objects in a namespace a user could have access to</em> is <em>high</em>.</p><p><strong><a href="#option-1-search-then-check">Search then Check</a></strong> is recommended to get the final list of results.</p><p>Note that this use case, because the user has access to a low number of objects which are still a high percentage of the total objects in the system, that means that the total number of objects in the system is low.</p><p><strong>C.</strong> The <em>number of objects of a certain type the user could have access to</em> is <em>low</em> (~ 100), and the <em>percentage of the total objects that the user can have access to</em> is also <em>low</em>.</p><p>In this case, an API to return the list of all objects a user can access would make sense. You can query this API to get a list of object IDs and then pass these IDs to your filter function to limit the search to them.</p><p>As this number increases, this solution becomes impractical, because you would need to paginate over multiple pages to get the entire list before being able to search and sort. A partial list from the API is not enough, because you won&#x27;t be able to sort using it.</p><p>So while <strong><a href="#option-3-build-a-list-of-ids-then-search">List of IDs then Search</a></strong> would be useful for this in some situations, we would recommend <strong><a href="#option-2-build-a-local-index-from-changes-endpoint-search-then-check">Local Index from Changes Endpoint, Search then Check</a></strong> for the cases when the number of objects is high enough. Until <!-- -->OpenFGA<!-- --> implements an endpoint to return a list of object IDs, local index is recommended for all situations.</p><p><strong>D.</strong> The <em>number of objects of a certain type the user could have access to</em> is <em>high</em>, and the <em>percentage of the total objects that the user can have access to</em> is <em>low</em>.</p><p>The recommended option for this case is to use <strong><a href="#option-2-build-a-local-index-from-changes-endpoint-search-then-check">Local Index from Changes Endpoint, Search then Check</a></strong>.</p><ul><li><p><em>List of IDs then Search</em> would not work because you would have to get and paginate across thousands or tens of thousands (or in some cases more) of results from <!-- -->OpenFGA<!-- -->, only after you have retrieved the entire set can you start searching within your database for matching results. This would mean that your user could be waiting for a long time before they can start seeing results.</p></li><li><p><em>Search then Check</em> would also not be ideal, as you will be retrieving and checking against a lot of items and discarding most of them.</p></li></ul><p>Use case: Searching in Google Drive, where the list of documents and folders that a user has access to can be very high, but it still is a small percentage of the entire set of documents in Google Drive.</p><p><strong>E.</strong> The <em>number of objects of a certain type the user could have access to</em> is <em>high</em>, and the <em>percentage of the total objects that the user can have access to</em> is also <em>high</em>.</p><p>In this case a <strong><a href="#option-2-build-a-local-index-from-changes-endpoint-search-then-check">Local Index from Changes Endpoint, Search then Check</a></strong> would be useful. If you do not want to maintain a local index, and if the user can access a high percentage of the total, meaning that the user is more likely than not to have access to the results returned by the search query, then <strong><a href="#option-1-search-then-check">Search then Check</a></strong> would work just as well.</p><p>Use-case: Searching on Twitter. Most Twitter users have their profiles set to public, so the user is more likely to have access to the tweets when performing a search. So searching first then running checks against the set of returned results would be appropriate.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="summary">Summary<a class="hash-link" href="#summary" title="Direct link to heading">​</a></h2><table><thead><tr><th>Scenario</th><th>Use Case</th><th># of objects returned from database query</th><th># of objects user can access in a type</th><th>% of objects user can access in a type</th><th>Preferred Option</th></tr></thead><tbody><tr><td>A</td><td>Search criteria enough to narrow down results</td><td>Low</td><td>-</td><td>-</td><td><a href="#option-1-search-then-check">1</a></td></tr><tr><td>B</td><td>Few objects the user has access to, but still a high % of total objects</td><td>Low</td><td>Low</td><td>High</td><td><a href="#option-1-search-then-check">1</a></td></tr><tr><td>C</td><td>Cannot narrow down search results, very high probability search returns objects user cannot access, total number of objects user can access is low enough to fit in a response</td><td>High</td><td>Low</td><td>Low</td><td><a href="#option-3-build-a-list-of-ids-then-search">3</a> or <a href="#option-2-build-a-local-index-from-changes-endpoint-search-then-check">2</a></td></tr><tr><td>D</td><td>Google Drive: User has access to a lot of documents, but low percentage from total</td><td>High</td><td>High</td><td>Low</td><td><a href="#option-2-build-a-local-index-from-changes-endpoint-search-then-check">2</a></td></tr><tr><td>E</td><td>Twitter Search: Most profiles are public, and the user can access them</td><td>High</td><td>High</td><td>High</td><td><a href="#option-1-search-then-check">1</a> or <a href="#option-2-build-a-local-index-from-changes-endpoint-search-then-check">2</a></td></tr></tbody></table></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/openfga/openfga.dev/edit/main/docs/content/interacting/search-with-permissions.mdx" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_eYIM" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vbeJ"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/interacting/read-tuple-changes"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">How to get tuple changes</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#possible-options" class="table-of-contents__link toc-highlight">Possible Options</a><ul><li><a href="#option-1-search-then-check" class="table-of-contents__link toc-highlight">Option 1: Search, Then Check</a></li><li><a href="#option-2-build-a-local-index-from-changes-endpoint-search-then-check" class="table-of-contents__link toc-highlight">Option 2: Build A Local Index From Changes Endpoint, Search, Then Check</a></li><li><a href="#option-3-build-a-list-of-ids-then-search" class="table-of-contents__link toc-highlight">Option 3: Build A List Of IDs, Then Search</a></li></ul></li><li><a href="#choosing-the-best-option" class="table-of-contents__link toc-highlight">Choosing The Best Option</a></li><li><a href="#summary" class="table-of-contents__link toc-highlight">Summary</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__links text--center"><div class="footer__links"><a href="https://twitter.com/OpenFGA" target="_blank" rel="noopener noreferrer" class="header-social header-twitter-link" aria-label="OpenFGA on Twitter">Twitter</a><span class="footer__link-separator">·</span><a href="https://discord.gg/8naAwJfWN6" target="_blank" rel="noopener noreferrer" class="header-social header-discord-link" aria-label="OpenFGA on Discord">Discord</a><span class="footer__link-separator">·</span><a href="https://github.com/openfga" target="_blank" rel="noopener noreferrer" class="header-social header-github-link" aria-label="OpenFGA on GitHub">Github</a></div></div><div class="footer__bottom text--center"><div class="footer__copyright">@ 2022</div></div></div></footer></div></div>
<script src="/assets/js/runtime~main.d5edf52b.js"></script>
<script src="/assets/js/main.bc493a09.js"></script>
</body>
</html>