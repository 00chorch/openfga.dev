"use strict";(self.webpackChunkopenfga_dev=self.webpackChunkopenfga_dev||[]).push([[4886],{87872:function(e,t,o){o.r(t),o.d(t,{assets:function(){return u},contentTitle:function(){return d},default:function(){return h},frontMatter:function(){return s},metadata:function(){return c},toc:function(){return m}});var n=o(87462),a=o(63366),i=(o(67294),o(3905)),r=o(80966),l=["components"],s={sidebar_position:8,slug:"/modeling/blocklists"},d="Blocklists",c={unversionedId:"content/modeling/blocklists",id:"content/modeling/blocklists",title:"Blocklists",description:"In this guide you'll see how to model preventing users from accessing objects using . For example, blocking users from accessing a document, even if it has been already shared with them.",source:"@site/docs/content/modeling/blocklists.mdx",sourceDirName:"content/modeling",slug:"/modeling/blocklists",permalink:"/docs/modeling/blocklists",draft:!1,editUrl:"https://github.com/openfga/openfga.dev/edit/main/docs/content/modeling/blocklists.mdx",tags:[],version:"current",sidebarPosition:8,frontMatter:{sidebar_position:8,slug:"/modeling/blocklists"},sidebar:"docs",previous:{title:"Parent-Child Objects",permalink:"/docs/modeling/parent-child"},next:{title:"Public Access",permalink:"/docs/modeling/public-access"}},u={},m=[{value:"Before you start",id:"before-you-start",level:2},{value:"Modeling User Groups",id:"modeling-user-groups",level:3},{value:"<ProductName format={ProductNameFormat.ShortForm} /> Concepts",id:"-concepts",level:3},{value:"Step by Step",id:"step-by-step",level:2},{value:"01. Modify our model so users can be blocked from accessing a document",id:"01-modify-our-model-so-users-can-be-blocked-from-accessing-a-document",level:3},{value:"02. Modify our model so users who are blocked can no longer edit the document",id:"02-modify-our-model-so-users-who-are-blocked-can-no-longer-edit-the-document",level:3},{value:"03. Verify our solution works",id:"03-verify-our-solution-works",level:3},{value:"a. Indicate that Carl is blocked from the planning document",id:"a-indicate-that-carl-is-blocked-from-the-planning-document",level:4},{value:"b. Carl (now blocked) can no longer edit the document",id:"b-carl-now-blocked-can-no-longer-edit-the-document",level:4},{value:"c. Becky still has edit access",id:"c-becky-still-has-edit-access",level:4},{value:"Related Sections",id:"related-sections",level:2}],p={toc:m};function h(e){var t=e.components,o=(0,a.Z)(e,l);return(0,i.kt)("wrapper",(0,n.Z)({},p,o,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"blocklists"},"Blocklists"),(0,i.kt)(r.AH,{mdxType:"DocumentationNotice"}),(0,i.kt)("p",null,"In this guide you'll see how to model preventing users from accessing objects using ",(0,i.kt)(r.rZ,{format:r.v7.ProductLink,mdxType:"ProductName"}),". For example, ",(0,i.kt)("inlineCode",{parentName:"p"},"blocking")," users from accessing a ",(0,i.kt)("inlineCode",{parentName:"p"},"document"),", even if it has been already shared with them."),(0,i.kt)(r.S1,{title:"When to use",appearance:"filled",description:(0,i.kt)("div",null,(0,i.kt)("p",null,"Exclusion is useful while building applications. You may need to support access patterns like granting access to some users, but excluding specific people or groups, similar to how users can block others from following them on social media, or prevent them from sharing documents on Google Drive."),(0,i.kt)("p",null,"This is useful when:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},'Implementing the "blocking" feature, such as the profile blocking commonly present on social media platforms (e.g. Instagram and Twitter).'),(0,i.kt)("li",{parentName:"ul"},"Reduce a user's access if they are part of a particular group (e.g. restricting access to members who are also guests, or restricting access to users in a certain locality)."))),mdxType:"CardBox"}),(0,i.kt)("h2",{id:"before-you-start"},"Before you start"),(0,i.kt)("p",null,"Before you start this guide, make sure you're familiar with some ",(0,i.kt)(r.uH,{mdxType:"ProductConcept"})," and know how to develop the things listed below."),(0,i.kt)("details",null,(0,i.kt)("summary",null,(0,i.kt)("p",null,"You will start with the ",(0,i.kt)("em",{parentName:"p"},(0,i.kt)(r.uH,{section:"what-is-an-authorization-model",linkName:"authorization model",mdxType:"ProductConcept"}))," below, it represents a ",(0,i.kt)("inlineCode",{parentName:"p"},"document")," ",(0,i.kt)("em",{parentName:"p"},(0,i.kt)(r.uH,{section:"what-is-a-type",linkName:"type",mdxType:"ProductConcept"}))," that can have users ",(0,i.kt)("strong",{parentName:"p"},(0,i.kt)(r.uH,{section:"what-is-a-relation",linkName:"related",mdxType:"ProductConcept"}))," as ",(0,i.kt)("inlineCode",{parentName:"p"},"editor"),", and ",(0,i.kt)("inlineCode",{parentName:"p"},"team")," type that can have users related as ",(0,i.kt)("inlineCode",{parentName:"p"},"member"),"."),(0,i.kt)("p",null,"Let us also assume that we have a ",(0,i.kt)("inlineCode",{parentName:"p"},"document"),' called "planning", shared for editing within the product ',(0,i.kt)("inlineCode",{parentName:"p"},"team")," (comprised of becky and carl).")),(0,i.kt)(r.lG,{configuration:{type_definitions:[{type:"document",relations:{editor:{this:{}}}},{type:"team",relations:{member:{this:{}}}}]},mdxType:"AuthzModelSnippetViewer"}),(0,i.kt)("p",null,"The current state of the system is represented by the following relationship tuples being in the system already:"),(0,i.kt)(r.Wz,{relationshipTuples:[{_description:"Members of the product team can edit the planning document",user:"team:product#member",relation:"editor",object:"document:planning"},{_description:"Becky is a member of the product team",user:"becky",relation:"member",object:"team:product"},{_description:"Carl is a member of the product team",user:"carl",relation:"member",object:"team:product"}],mdxType:"RelationshipTuplesViewer"}),(0,i.kt)("hr",null),(0,i.kt)("p",null,"In addition, you will need to know the following:"),(0,i.kt)("h3",{id:"modeling-user-groups"},"Modeling User Groups"),(0,i.kt)("p",null,"You need to know how to add users to groups and grant groups access to resources. ",(0,i.kt)("a",{parentName:"p",href:"/docs/modeling/user-groups"},"Learn more \u2192")),(0,i.kt)("h3",{id:"-concepts"},(0,i.kt)(r.rZ,{format:r.v7.ShortForm,mdxType:"ProductName"})," Concepts"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"A ",(0,i.kt)(r.uH,{section:"what-is-a-type",linkName:"Type",mdxType:"ProductConcept"}),": a class of objects that have similar characteristics"),(0,i.kt)("li",{parentName:"ul"},"A ",(0,i.kt)(r.uH,{section:"what-is-a-user",linkName:"User",mdxType:"ProductConcept"}),": an entity in the system that can be related to an object"),(0,i.kt)("li",{parentName:"ul"},"A ",(0,i.kt)(r.uH,{section:"what-is-a-relation",linkName:"Relation",mdxType:"ProductConcept"}),": is a string defined in the type definition of an authorization model that defines the possibility of a relationship between objects of this type and other users in the system"),(0,i.kt)("li",{parentName:"ul"},"An ",(0,i.kt)(r.uH,{section:"what-is-an-object",linkName:"Object",mdxType:"ProductConcept"}),": represents an entity in the system. Users' relationships to it can be define through relationship tuples and the authorization model"),(0,i.kt)("li",{parentName:"ul"},"A ",(0,i.kt)(r.uH,{section:"what-is-a-relationship-tuple",linkName:"Relationship Tuple",mdxType:"ProductConcept"}),": a grouping consisting of a user, a relation and an object stored in ",(0,i.kt)(r.rZ,{format:r.v7.ShortForm,mdxType:"ProductName"})),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/docs/configuration-language#the-exclusion-operator"},"Exclusion Operator"),": the exclusion operator can be used to exclude certain usersets from being related to an object"))),(0,i.kt)(r.XQ,{mdxType:"Playground"}),(0,i.kt)("h2",{id:"step-by-step"},"Step by Step"),(0,i.kt)("p",null,"With the above authorization model and relationship tuples, ",(0,i.kt)(r.rZ,{format:r.v7.LongForm,mdxType:"ProductName"})," will correctly respond with ",(0,i.kt)("inlineCode",{parentName:"p"},'{"allowed":true}')," when ",(0,i.kt)(r.uH,{section:"what-is-a-check-request",linkName:"check",mdxType:"ProductConcept"})," is called to see if Carl and Becky can edit this ",(0,i.kt)("inlineCode",{parentName:"p"},"document"),"."),(0,i.kt)("p",null,"We can verify that by issuing two check requests:"),(0,i.kt)(r.uT,{user:"becky",relation:"editor",object:"document:planning",allowed:!0,mdxType:"CheckRequestViewer"}),(0,i.kt)(r.uT,{user:"carl",relation:"editor",object:"document:planning",allowed:!0,mdxType:"CheckRequestViewer"}),(0,i.kt)("p",null,"We want to share a document with the product team and also have the ability to deny certain users access, even if they have the document shared with them already. We can verify this by blocking Carl (who we have seen already has edit access) from editing the document."),(0,i.kt)("p",null,"In order to do that, we need to:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("a",{parentName:"li",href:"#01-modify-our-model-to-allow-indicating-that-users-can-be-blocked-from-accessing-a-document"},"Modify our model to allow indicating that users can be blocked from accessing a document")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("a",{parentName:"li",href:"#02-modify-our-model-to-indicate-that-users-who-are-blocked-can-no-longer-edit-the-document"},"Modify our model to indicate that users who are blocked can no longer edit the document")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("a",{parentName:"li",href:"#03-verify-that-our-solution-works"},"Verify that our solution works"),":")),(0,i.kt)("p",null,"a. ",(0,i.kt)("a",{parentName:"p",href:"#a-indicate-that-carl-is-blocked-from-the-planning-document"},"Indicate that Carl is blocked from the planning document")),(0,i.kt)("p",null,"b. ",(0,i.kt)("a",{parentName:"p",href:"#b-carl-now-blocked-can-no-longer-edit-the-document"},"Carl (now blocked) can no longer edit the document")),(0,i.kt)("p",null,"c. ",(0,i.kt)("a",{parentName:"p",href:"#c-becky-still-has-edit-access"},"Becky still has edit access")),(0,i.kt)("h3",{id:"01-modify-our-model-so-users-can-be-blocked-from-accessing-a-document"},"01. Modify our model so users can be blocked from accessing a document"),(0,i.kt)("p",null,'To allow users to be "blocked" from accessing a ',(0,i.kt)("inlineCode",{parentName:"p"},"document"),", we first need to allow this relation. We'll update our store model to add a ",(0,i.kt)("inlineCode",{parentName:"p"},"blocked")," ",(0,i.kt)(r.uH,{section:"what-is-a-relation",linkName:"relation",mdxType:"ProductConcept"})," to the ",(0,i.kt)("inlineCode",{parentName:"p"},"document")," type."),(0,i.kt)("p",null,"The authorization model becomes this:"),(0,i.kt)(r.lG,{configuration:{type_definitions:[{type:"document",relations:{blocked:{this:{}},editor:{this:{}}}},{type:"team",relations:{member:{this:{}}}}]},mdxType:"AuthzModelSnippetViewer"}),(0,i.kt)("p",null,"Now we can add relationship tuples indicating that a certain user is ",(0,i.kt)("inlineCode",{parentName:"p"},"blocked")," from editing a ",(0,i.kt)("inlineCode",{parentName:"p"},"document"),"."),(0,i.kt)("h3",{id:"02-modify-our-model-so-users-who-are-blocked-can-no-longer-edit-the-document"},"02. Modify our model so users who are blocked can no longer edit the document"),(0,i.kt)("p",null,"Now that we can mark users as ",(0,i.kt)("inlineCode",{parentName:"p"},"blocked")," from editing documents, we need to support denying the ",(0,i.kt)("inlineCode",{parentName:"p"},"editor")," relationship when a user is ",(0,i.kt)("inlineCode",{parentName:"p"},"blocked"),". We do that by modifying the relation definition of ",(0,i.kt)("inlineCode",{parentName:"p"},"editor"),", and making use of the ",(0,i.kt)("a",{parentName:"p",href:"/docs/configuration-language#the-exclusion-operator"},(0,i.kt)("strong",{parentName:"a"},"the exclusion operator"))," to exclude the set of ",(0,i.kt)("inlineCode",{parentName:"p"},"blocked")," users, as we can see here:"),(0,i.kt)(r.lG,{configuration:{type_definitions:[{type:"document",relations:{blocked:{this:{}},editor:{difference:{base:{this:{}},subtract:{computedUserset:{relation:"blocked"}}}}}},{type:"team",relations:{member:{this:{}}}}]},mdxType:"AuthzModelSnippetViewer"}),(0,i.kt)("h3",{id:"03-verify-our-solution-works"},"03. Verify our solution works"),(0,i.kt)("p",null,"To check if our new model works, we'll add a relationship tuple with Carl as ",(0,i.kt)("inlineCode",{parentName:"p"},"blocked")," from ",(0,i.kt)("inlineCode",{parentName:"p"},"document:planning")," and then verify that Carl no longer has ",(0,i.kt)("inlineCode",{parentName:"p"},"editor")," access to that document."),(0,i.kt)("h4",{id:"a-indicate-that-carl-is-blocked-from-the-planning-document"},"a. Indicate that Carl is blocked from the planning document"),(0,i.kt)("p",null,"With our modified authorization model, we can indicate that Carl is blocked by adding this ",(0,i.kt)("em",{parentName:"p"},(0,i.kt)(r.uH,{section:"what-is-a-relationship-tuple",linkName:"relationship tuple",mdxType:"ProductConcept"})),"."),(0,i.kt)(r.Gb,{relationshipTuples:[{_description:"Carl is blocked from editing the planning document",user:"carl",relation:"blocked",object:"document:planning"}],mdxType:"WriteRequestViewer"}),(0,i.kt)("h4",{id:"b-carl-now-blocked-can-no-longer-edit-the-document"},"b. Carl (now blocked) can no longer edit the document"),(0,i.kt)("p",null,"We have modified the authorization model and added relationship tuples to indicate that Carl is ",(0,i.kt)("inlineCode",{parentName:"p"},"blocked"),". Now let's make sure our solution works as expected."),(0,i.kt)("p",null,"To check if Carl still has access to the document, we can issue a check request with Carl as the user."),(0,i.kt)(r.uT,{user:"carl",relation:"editor",object:"document:planning",allowed:!1,mdxType:"CheckRequestViewer"}),(0,i.kt)("p",null,"The response is ",(0,i.kt)("inlineCode",{parentName:"p"},"false"),", so our solution is working as expected."),(0,i.kt)("h4",{id:"c-becky-still-has-edit-access"},"c. Becky still has edit access"),(0,i.kt)("p",null,"To check if Becky still has access to the document, we'll issue another check request with Becky as the user."),(0,i.kt)(r.uT,{user:"becky",relation:"editor",object:"document:planning",allowed:!0,mdxType:"CheckRequestViewer"}),(0,i.kt)("p",null,"The response is ",(0,i.kt)("inlineCode",{parentName:"p"},"true"),", indicating our model change did not inadvertently deny access for users who have access but are not blocked."),(0,i.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},(0,i.kt)("strong",{parentName:"p"},"Note:")," When creating tuples for ",(0,i.kt)(r.rZ,{format:r.v7.LongForm,mdxType:"ProductName"})," make sure to use unique ids for each object and user within your application domain. We are using first names and human-readable identifiers to make this task easier to read."))),(0,i.kt)("h2",{id:"related-sections"},"Related Sections"),(0,i.kt)(r.$q,{description:"Check the following sections for more on how to model with {ProductName}.",relatedLinks:[{title:"Modeling: Getting Started",description:"Learn about how to get started with modeling.",link:"./getting-started",id:"./getting-started"},{title:"Configuration Language",description:"Learn about {ProductName} Configuration Language.",link:"../configuration-language",id:"../configuration-language"},{title:"Public Access",description:"Learn about model public access.",link:"./public-access",id:"./public-access"}],mdxType:"RelatedSection"}))}h.isMDXComponent=!0}}]);